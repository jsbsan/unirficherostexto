' Gambas class file

Public Sub Form_Open()

  Settings.Read(Me)
  Label3.Text = User.Home & "/PDF/unidos.txt"

End

Public Sub ButtonUNIR_Click()

  unirficheros

End

Public Sub Label1_MouseDown()

End

Public Sub Form_Close()

  Settings.Write(Me)

End

Public Sub unirficheros()

  Dim nombres As String[]
  Dim n As String
  Dim contenido As String
  Dim horacreacion As String
  '  Dim nombrecompleto As String

  TextArea1.Text = Replace(TextArea1.text, "file://", "")
  TextArea1.Text = Replace(TextArea1.text, "\r", "")
  TextArea1.Text = Replace(TextArea1.text, "%20", " ")

  nombres = Split(TextArea1.text, "\n")

  For Each n In nombres
    If Exist(n) Then
      contenido &= File.Load(n)
      ' nombrecompleto &= "_" & Replace(File.BaseName(n), "test_", "")
    Endif

  Next

  horacreacion = Format(Now, "yyyy_mm_dd_hh_nn_ss")

  File.Save(User.Home & "/PDF/unido" & horacreacion & ".csv", contenido)
  Label3.Text = User.Home & "/PDF/unido" & horacreacion & ".csv" 'para que no de problemas con el nombre muy largo
  Label3.Tooltip = User.Home & "/PDF/unido" & horacreacion & ".csv"
  Message.Info("terminado de unir ficheros" & "\n" & horacreacion)

End
